{{- $backendName := include "cdp.backend.fullname" . }}
{{- $enclaveName := include "cdp.enclave.fullname" . }}
{{- $dataserviceName := include "cdp.dataservice.fullname" . }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ $backendName }}-config
  labels:
    {{- include "cdp.backend.labels" . | nindent 4 }}
data:
  API_ENDPOINT: "http://{{ $backendName }}:{{ .Values.backend.service.api.port }}/graphql"
  ATLAS_URL: "{{ .Values.backend.atlasUrl }}"
  FILES_ENDPOINT: "http://{{ $backendName }}:{{ .Values.backend.service.api.port }}/"
  SERVER_PORT: "{{ .Values.backend.configs.listenPort }}"
  LOG_LEVEL: "{{ .Values.backend.configs.logLevel }}"
  ALARM_NOTIFICATION_EMAIL: "{{ .Values.backend.configs.alarmEmail }}"
  CLICKHOUSE_HOST: "{{ .Values.backend.configs.clickhouseHost }}"
  CLICKHOUSE_PORT: "{{ .Values.backend.configs.clickhousePort }}"
  CLICKHOUSE_DB: "{{ .Values.backend.configs.clickhouseDb }}"
  EOS_NODE_URL: "{{ .Values.backend.configs.eosNodeUrl }}"
  EOS_WALLET_ORG_ID: "{{ .Values.backend.configs.eosWalletOwnerOrgId }}"
  EOS_WALLET_PUBLIC_KEY: "{{ .Values.backend.configs.eosWalletOwnerPub }}"
  ENCLAVE_LOCAL_PROVIDER_NAME: "{{ .Values.backend.configs.providerName }}"
  CURRENT_PROVIDER_NAME: "{{ .Values.backend.configs.providerName }}"
  PROVIDER_INSTANCE_ID: "{{ .Values.backend.configs.providerInstanceId }}"
  ENCLAVE_ENDPOINT: "{{ .Values.backend.configs.enclaveEndpoint | default (printf "http://%s:%v/v1" $enclaveName .Values.enclave.service.port) }}"
  ENCLAVE_SCRIPTS_AUDITORY: "{{ .Values.enclave.scripts.auditory }}"
  ENCLAVE_SCRIPTS_DATALAB: "{{ .Values.enclave.scripts.datalab }}"
  ENCLAVE_SCRIPTS_SEGMENT: "{{ .Values.enclave.scripts.segment }}"
  ENCLAVE_SCRIPTS_SEGMENT_CRITERIES: "{{ .Values.enclave.scripts.segmentCriteries }}"
  ENCLAVE_SCRIPTS_STATISTIC: "{{ .Values.enclave.scripts.statistics }}"
  ENCLAVE_DMP_API_SECRET: "{{ .Values.backend.configs.dmpSecret }}"
  ENCLAVE_KNOWN_PROVIDERS: '{{ .Values.providers | toJson }}'
  EMAIL_NOTIFICATIONS: '{{ .Values.backend.configs.email | toJson }}'
  CALC_REPORT_DEFAULT_GOODS_DIRECTORY: "{{ .Values.backend.configs.reportDefaultGoodsDirectory }}"
  DICTS_BRANDS: "{{ .Values.backend.configs.dictMode }}"
  DICTS_VENDORS: "{{ .Values.backend.configs.dictMode }}"
  SUPPORT_EMAIL: "{{ .Values.backend.configs.supportEmail }}"
  BASE_URL: "{{ .Values.backend.configs.baseUrl }}"
  DATA_SERVICE_ENDPOINT: "http://{{ $dataserviceName }}:{{ .Values.dataservice.service.port }}/api/"
  DATA_SERVICE_TOKEN: "{{ .Values.dataservice.config.accessToken }}"
