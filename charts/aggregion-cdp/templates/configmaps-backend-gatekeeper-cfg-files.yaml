{{- if .Values.backend.gatekeeper.enabled }}
{{- $frontendName := include "cdp.backend.fullname" . }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: backend-gatekeeper-config
  labels:
    {{- include "cdp.backend.labels" . | nindent 4 }}
data:
  config.yaml: |
    {{- toYaml .Values.backend.gatekeeper.config | nindent 4 }}
    client-id: backend
    client-secret: GF4nFFNJgt8ae7giPXEQZ9WehMImZuYh
    discovery-url: http://keycloak/realms/ad1/.well-known/openid-configuration
    enable-default-deny: true
    enable-metrics: false
    enable-refresh-tokens: true
    encryption-key: RfvTgbYHNujm8IKl
    skip-openid-provider-tls-verify: true
    listen: :3000
    listen-admin: :4000
    no-redirects: true
    secure-cookie: false
    redirection-url: https://test.dcp.bm.dev.aggregion.com
    upstream-url: http://127.0.0.1:5000
    resources:
    - uri: /graphql
    methods:
    - GET
    white-listed: true
{{- end }}
